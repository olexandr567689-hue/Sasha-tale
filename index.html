<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>—Å–∞—à–∏–Ω—ñ-–∫–∞–∑–∫–∏: WEB EDITION</title>
    <style>
        :root { --ut-red: #ff0000; --ut-yellow: #ffff00; --ut-green: #00ff00; --ut-blue: #4deeea; }
        body { background: #000; color: #fff; margin: 0; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; touch-action: none; }
        
        #intro-layer { position: fixed; inset: 0; background: #000; z-index: 3000; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        
        .btn-ui { border: 2px solid #fff; padding: 15px 20px; cursor: pointer; margin: 10px; font-weight: bold; background: #000; color: #fff; width: 280px; font-size: 16px; z-index: 3001; }
        .btn-ui:active { background: #fff; color: #000; }

        #game-container { display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; }
        #boss-area { height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; }
        
        #battle-screen { position: relative; border: 4px solid #fff; width: 300px; height: 140px; background: #000; overflow: hidden; margin-top: 10px; }
        #heart { position: absolute; width: 16px; height: 16px; background: var(--ut-red); z-index: 100; border-radius: 2px; display: none; }
        
        #menu { display: flex; gap: 4px; width: 310px; margin-top: 10px; }
        .btn-m { flex: 1; border: 2px solid orange; color: orange; padding: 12px 0; font-size: 10px; text-align: center; font-weight: bold; cursor: pointer; }
        .btn-m.active { background: #332200; color: var(--ut-yellow); border-color: var(--ut-yellow); }

        #controls { margin-top: auto; padding-bottom: 20px; display: flex; width: 100%; justify-content: space-around; }
        .d-pad { display: grid; grid-template-columns: repeat(3, 60px); gap: 8px; }
        .d-btn { background: #222; border: 2px solid #fff; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 20px; border-radius: 8px; color: white; user-select: none; }
        #btn-z { width: 70px; height: 70px; background: #222; border: 4px solid var(--ut-yellow); color: var(--ut-yellow); border-radius: 50%; font-size: 28px; font-weight: bold; display: flex; align-items: center; justify-content: center; }

        .wall { position: absolute; background: #00a2ff; border: 1px solid #fff; z-index: 50; }
        #attack-bar { position:absolute; inset:0; border:2px solid #fff; display:none; background:#000; z-index: 500; }
        #slider { position:absolute; left:0; top:0; width:12px; height:100%; background:#fff; }
    </style>
</head>
<body>

    <div id="intro-layer">
        <h1 style="color: var(--ut-yellow);">–°–ê–®–ò–ù–Ü-–ö–ê–ó–ö–ò</h1>
        <p style="font-size: 12px;">v1.2.6 (GITHUB READY)</p>
        <button class="btn-ui" id="start-trigger">–ü–û–ß–ê–¢–ò –ì–†–£</button>
    </div>

    <div id="screen-name" class="overlay">
        <h2>–¢–í–û–Ñ –Ü–ú'–Ø?</h2>
        <input type="text" id="input-name" value="SASHA" maxlength="8" style="background:#000; color:#fff; border:2px solid #fff; padding:10px; font-size:18px; text-align:center;">
        <button class="btn-ui" onclick="goToChoice()">–î–ê–õ–Ü</button>
    </div>

    <div id="screen-choice" class="overlay">
        <h2>–û–ë–ï–†–ò –í–û–†–û–ì–ê</h2>
        <button class="btn-ui" onclick="startGame(1)">üëª –ù–ê–ü–°–¢–ê–ë–õ–£–ö</button>
        <button class="btn-ui" style="color:var(--ut-red);" onclick="startGame(2)">üß± –ê–ù–î–†1015 (–ë–û–°)</button>
    </div>

    <div id="game-container">
        <div id="boss-area">
            <div id="enemy-sprite" style="font-size: 60px;">ü§ñ</div>
            <div id="hp-bar" style="width:200px; height:10px; background:#333; border:2px solid #fff; margin-top:10px;">
                <div id="hp-fill" style="width:100%; height:100%; background:var(--ut-green);"></div>
            </div>
        </div>
        <div id="battle-screen">
            <div id="heart"></div>
            <div id="dialog" style="padding:10px; font-size:14px;">* –í–∏ –≥–æ—Ç–æ–≤—ñ?</div>
            <div id="attack-bar"><div id="slider"></div></div>
        </div>
        <div id="menu">
            <div id="m0" class="btn-m active" onclick="setMenu(0)">FIGHT</div>
            <div id="m1" class="btn-m" onclick="setMenu(1)">ACT</div>
            <div id="m2" class="btn-m" onclick="setMenu(2)">ITEM</div>
            <div id="m3" class="btn-m" onclick="setMenu(3)">MERCY</div>
        </div>
        <div id="controls">
            <div class="d-pad">
                <div class="d-btn" style="grid-column:2" ontouchstart="keys.up=true" ontouchend="keys.up=false">‚ñ≤</div>
                <div class="d-btn" style="grid-column:1" ontouchstart="keys.left=true" ontouchend="keys.left=false">‚óÄ</div>
                <div class="d-btn" style="grid-column:3" ontouchstart="keys.right=true" ontouchend="keys.right=false">‚ñ∂</div>
                <div class="d-btn" style="grid-column:2" ontouchstart="keys.down=true" ontouchend="keys.down=false">‚ñº</div>
            </div>
            <div id="btn-z" onclick="pressZ()">Z</div>
        </div>
    </div>

    <script>
        let pName="SASHA", hp=20, eHp=1000, maxE=1000, act=0;
        let mode='INTRO', menuIdx=0, sPos=0, sDir=1, px=142, py=62, audioCtx;
        const keys={up:false, down:false, left:false, right:false};

        // –°–ò–ù–¢–ï–ó–ê–¢–û–† MEGALOVANIA
        function startMusic() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const notes = [293, 293, 587, 440, 415, 392, 349, 293, 349, 392];
            let i = 0;
            setInterval(() => {
                if(hp <= 0) return;
                let osc = audioCtx.createOscillator();
                let g = audioCtx.createGain();
                osc.type = 'square';
                osc.frequency.value = notes[i % notes.length];
                g.gain.setValueAtTime(0.015, audioCtx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.1);
                osc.connect(g); g.connect(audioCtx.destination);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
                i++;
            }, 125);
        }

        document.getElementById('start-trigger').onclick = () => {
            startMusic();
            document.getElementById('intro-layer').style.display='none';
            document.getElementById('screen-name').style.display='flex';
        };

        function goToChoice() {
            pName = document.getElementById('input-name').value || "SASHA";
            document.getElementById('screen-name').style.display='none';
            document.getElementById('screen-choice').style.display='flex';
        }

        function startGame(id) {
            eHp = id === 2 ? 3000 : 1000; maxE = eHp;
            document.getElementById('enemy-sprite').innerText = id === 2 ? "üß±" : "üëª";
            document.getElementById('screen-choice').style.display='none';
            document.getElementById('game-container').style.display='flex';
            mode='MENU'; requestAnimationFrame(loop);
        }

        function setMenu(i) { if(mode==='MENU') { menuIdx=i; [0,1,2,3].forEach(n=>document.getElementById('m'+n).classList.toggle('active', n===i)); }}

        function pressZ() {
            if(mode==='MENU') {
                if(menuIdx===0) { mode='ATTACK'; document.getElementById('attack-bar').style.display='block'; sPos=0; }
                else if(menuIdx===1) { act++; msg("* –í–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏–ª–∏ –≤–æ—Ä–æ–≥–∞."); next(); }
                else if(menuIdx===2) { hp=Math.min(20, hp+10); msg("* +10 HP!"); updateUI(); next(); }
                else if(menuIdx===3) { if(act>=3) { alert('–ú–ò–†!'); location.reload(); } else next(); }
            } else if(mode==='ATTACK') {
                let d = Math.abs(sPos-150)<20?500:100; eHp-=d;
                document.getElementById('attack-bar').style.display='none';
                msg("* –£–î–ê–†: "+d); setTimeout(()=>eHp<=0?location.reload():enemyTurn(), 800);
            }
        }

        function msg(t) { document.getElementById('dialog').innerText=t; }
        function next() { mode='BUSY'; setTimeout(enemyTurn, 600); }

        function enemyTurn() {
            mode='DODGE'; px=142; py=62; document.getElementById('heart').style.display='block';
            let t=0;
            const turn = setInterval(() => {
                t++; spawnWall();
                if(t>30 || hp<=0) {
                    clearInterval(turn); document.getElementById('heart').style.display='none';
                    if(hp<=0) { alert('–ö–Ü–ù–ï–¶–¨'); location.reload(); }
                    else { mode='MENU'; updateUI(); msg("* –í–∞—à —Ö—ñ–¥."); }
                }
            }, 200);
        }

        function spawnWall() {
            const w=document.createElement('div'); w.className='wall';
            w.style.width='70px'; w.style.height='15px'; w.style.top=Math.random()*110+'px'; w.style.left='-70px';
            document.getElementById('battle-screen').appendChild(w);
            let x=-70; const m=setInterval(()=>{
                x+=6; w.style.left=x+'px';
                if(checkCol(w)){ hp-=4; w.remove(); clearInterval(m); updateUI(); }
                if(x>300 || mode!=='DODGE') { w.remove(); clearInterval(m); }
            },30);
        }

        function checkCol(el) {
            const hr=document.getElementById('heart').getBoundingClientRect(), er=el.getBoundingClientRect();
            return !(er.left>hr.right||er.right<hr.left||er.top>hr.bottom||er.bottom<hr.top);
        }

        function updateUI() { 
            document.getElementById('hp-fill').style.width=(eHp/maxE*100)+"%"; 
        }

        function loop() {
            if(mode==='DODGE') {
                if(keys.up && py > 2) py -= 4; if(keys.down && py < 122) py += 4;
                if(keys.left && px > 2) px -= 4; if(keys.right && px < 282) px += 4;
                heart.style.left=px+'px'; heart.style.top=py+'px';
            }
            if(mode==='ATTACK') { sPos+=(10*sDir); if(sPos>288||sPos<0) sDir*=-1; slider.style.left=sPos+'px'; }
            requestAnimationFrame(loop);
        }

        window.addEventListener('keydown', e => { if(e.key.includes('Arrow')) keys[e.key.replace('Arrow','').toLowerCase()] = true; if(e.key==='z') pressZ(); });
        window.addEventListener('keyup', e => { if(e.key.includes('Arrow')) keys[e.key.replace('Arrow','').toLowerCase()] = false; });
    </script>
</body>
</html>

